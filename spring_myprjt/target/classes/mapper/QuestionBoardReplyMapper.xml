<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="QuestionBoardReplyMapper">

	<insert id="insertReplyBoard" parameterType="questionBoardReplyVo">
		insert into question_board_reply
		(reply_idx, all_reply_number, content, member_idx, board_idx, member_nickname)
		values(question_board_reply_seq.nextval, all_board_reply_seq.nextval, #{content}, #{member_idx}, #{board_idx}, #{member_nickname})
	</insert>
	
	<select id="selectReplyCount" parameterType="_int" resultType="_int">
		select count(*) from question_board_reply where board_idx = #{board_idx} order by reply_idx desc				
	</select>	

	<select id="selectReplyList" parameterType="_int" resultType="questionBoardReplyVo">
		select * from question_board_reply where board_idx = #{board_idx} order by reply_idx desc
	</select>
	
	<update id="updateReplyCount" parameterType="_int">
		update question_board 
			set reply_count = (
				select count(*)
				from question_board_reply
				where question_board_reply.board_idx = question_board.board_idx) 
			where board_idx = #{board_idx}
	</update>	
	
	<update id="updateBoardReply" parameterType="questionBoardReplyVo">
		update question_board_reply set content = #{content} where reply_idx = #{reply_idx}
	</update>	
	
	<select id="selectReplyView" parameterType="_int" resultType="questionBoardReplyVo">
		select * from question_board_reply where reply_idx = #{reply_idx}
	</select>	
	
	<delete id="deleteReply" parameterType="questionBoardReplyVo">
		delete from question_board_reply where reply_idx = #{reply_idx}
	</delete>					
</mapper>